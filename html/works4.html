<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Polygon Video Gallery</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: radial-gradient(#0d0d1a, #000);
      font-family: sans-serif;
    }
    #popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
      display: none;
    }
    #popup iframe {
      width: 80vw;
      height: 80vh;
      border: none;
      border-radius: 12px;
    }
    #popup.close {
      display: none;
    }
  </style>
</head>
<body>
  <div id="popup" onclick="this.style.display='none'; this.innerHTML = ''"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r148/three.min.js"></script>
  <script>
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    camera.position.z = 10;

    const categories = [
      {
        name: "Belleza",
        videos: [
          { thumbnail: "https://vz-442d8bc3-9f6.b-cdn.net/de22cd3e...preview.webp?v=1751979933", url: "https://iframe.mediadelivery.net/embed/463997/de22cd3e...?autoplay=true" },
          // ... agrega más videos aquí
        ]
      },
      // ... agrega más categorías aquí
    ];

    const loader = new THREE.TextureLoader();

    function createPolyhedron(category) {
      const geometry = new THREE.DodecahedronGeometry(2);
      const materials = category.videos.map(video =>
        new THREE.MeshBasicMaterial({
          map: loader.load(video.thumbnail),
          transparent: true,
          opacity: 0.95,
          side: THREE.DoubleSide
        })
      );
      while (materials.length < 12) materials.push(materials[0]);

      const mesh = new THREE.Mesh(geometry, materials);
      mesh.userData.category = category;
      mesh.rotationSpeed = Math.random() * 0.01;
      mesh.position.x = (Math.random() - 0.5) * 20;
      mesh.position.y = (Math.random() - 0.5) * 20;
      mesh.position.z = (Math.random() - 0.5) * 20;

      scene.add(mesh);
      return mesh;
    }

    const meshes = categories.map(createPolyhedron);

    function animate() {
      requestAnimationFrame(animate);
      meshes.forEach(m => m.rotation.y += m.rotationSpeed);
      renderer.render(scene, camera);
    }
    animate();

    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();
    window.addEventListener('click', event => {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObjects(meshes);
      if (intersects.length > 0) {
        const cat = intersects[0].object.userData.category;
        const randomVid = cat.videos[Math.floor(Math.random() * cat.videos.length)].url;
        const popup = document.getElementById('popup');
        popup.innerHTML = `<iframe src="${randomVid}" allow="autoplay"></iframe>`;
        popup.style.display = 'flex';
      }
    });
  </script>
</body>
</html>
