<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Globe with Star Points</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            background: radial-gradient(circle at 30% 30%, #f3e9dc, #d5c2aa, #a68b73);
            background-blend-mode: screen;
            overflow: hidden;
            position: relative;
        }
        
        /* Sparkling Stars */
        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            background: transparent;
            pointer-events: none;
            z-index: 1;
        }
        
        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite ease-in-out;
            opacity: 0.8;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); }
        }
        
        /* Optional noise texture */
        .noise {
            pointer-events: none;
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: url('https://www.transparenttextures.com/patterns/noise.png');
            opacity: 0.03;
            z-index: 2;
        }
        
        .text-overlay { 
            position: absolute; 
            top: 20px; 
            left: 50%; 
            transform: translateX(-50%); 
            color: white; 
            background: #3d5048af; 
            padding: 15px; 
            border-radius: 10px; 
            text-align: center; 
            max-width: 600px; 
            font-size: 16px; 
            z-index: 6;
        }
        
        canvas { 
            display: block; 
            background-color: transparent;
            padding: 0, 50px, 0, 0;
            margin-top: 0px;
            position: relative;
            z-index: 5;
        }
        
        .text-overlay strong { color: #FFFDD0; }
        
        .star-point {
            position: absolute;
            width: 20px;
            height: 20px;
            pointer-events: none;
            background: conic-gradient(
            from 45deg,
            #f7f2e1,
            #f7f2e1 25%,
            #f7f2e1 25%,
            #f7f2e1 50%,
            #f7f2e1 50%,
            #f7f2e1 75%,
            #f7f2e1 75%,
            #f7f2e1 100%
            );
            clip-path: polygon(
            50% 0%,
            60% 40%,
            100% 50%,
            60% 60%,
            50% 100%,
            40% 60%,
            0% 50%,
            40% 40%
            );
            animation: pulseStar 1.5s infinite ease-in-out;
            filter: drop-shadow(0 0 6px #f7f2e1);
            z-index: 10;
        }
        
        /* Add glowing yellow center */
        .star-point::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 247, 178, 0.9) 0%, rgba(255,255,255,0) 70%);
            pointer-events: none;
            z-index: -1;
        }
        
        @keyframes pulseStar {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.7;
            }
        }
        
        /***************************** MOBILE STYLES *****************************/
        @media (max-width: 768px) {
            .text-overlay { width: 85%; }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    <div class="noise"></div>
    <!-- Market Content -->
    <div class="text-overlay">
        Más de <strong>300 marcas</strong> ya confían en mí cada día para recibir contenidos únicos y hechos a medida.  
        <br><br>
        ¿Quieres llevar tus redes al siguiente nivel?  
        <strong>Escríbeme hoy</strong> y recibe el contenido especial que tu proyecto merece ✨
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script>
        // Set up scene, camera, and renderer
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true }); // Enable alpha for background transparency
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        
        // Add orbit controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.autoRotate = false;
        
        // Load textures
        const textureLoader = new THREE.TextureLoader();
        const mapTexture = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_atmos_2048.jpg');
        const bumpTexture = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_bump_2048.jpg');
        
        // Create globe with world map texture
        const radius = 15;
        const geometry = new THREE.SphereGeometry(radius, 64, 64);
        const material = new THREE.MeshPhongMaterial({
            map: mapTexture,
            bumpMap: bumpTexture,
            bumpScale: 0.1,
            specular: 0x333333, // Darker specular for less glare
            shininess: 10 // Reduced shininess
        });
        const globe = new THREE.Mesh(geometry, material);
        scene.add(globe);
        
        // Add lighting (darker to preserve background)
        const ambientLight = new THREE.AmbientLight(0xffffff); // Darker ambient light
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0x888888, 0.3); // Dimmer directional light
        directionalLight.position.set(10, 10, 10);
        scene.add(directionalLight);
        
        // Define points (40 in Spain, 5 in Germany, 5 in France)
        const pointsData = [
        // Spain (40 points)
        { lat: 40.416775, lon: -3.703790, name: "Compañía de Moda, Madrid" },
        { lat: 41.385064, lon: 2.173404, name: "Compañía de Joyas, Barcelona" },
        { lat: 37.389092, lon: -5.984459, name: "Estudio de Diseño, Seville" },
        { lat: 39.469907, lon: -0.376288, name: "Agencia de Publicidad, Valencia" },
        { lat: 43.263013, lon: -2.934985, name: "Marca de Arte, Bilbao" },
        { lat: 40.463667, lon: -3.749220, name: "Estudio de Fotografía, Madrid" },
        { lat: 41.403638, lon: 2.174355, name: "Tienda de Accesorios, Barcelona" },
        { lat: 37.392529, lon: -5.975137, name: "Productora de Vídeo, Seville" },
        { lat: 39.466667, lon: -0.375000, name: "Marca de Ropa, Valencia" },
        { lat: 43.257795, lon: -2.923739, name: "Galería de Arte, Bilbao" },
        ...Array(30).fill().map((_, i) => ({
            lat: 36 + Math.random() * 8,
            lon: -9 + Math.random() * 7,
            name: `Creador de Contenido ${i + 1}, Spain`
        })),
        // Germany (5 points)
        { lat: 52.520008, lon: 13.404954, name: "Compañía de Tecnología, Berlin" },
        { lat: 48.137154, lon: 11.576124, name: "Estudio de Diseño, Munich" },
        { lat: 50.110924, lon: 8.682127, name: "Agencia de Marketing, Frankfurt" },
        { lat: 53.551085, lon: 9.993682, name: "Marca de Moda, Hamburg" },
        { lat: 50.937531, lon: 6.960279, name: "Productora de Eventos, Cologne" },
        // France (5 points)
        { lat: 48.856614, lon: 2.352222, name: "Compañía de Moda, Paris" },
        { lat: 43.296482, lon: 5.369780, name: "Estudio de Arte, Marseille" },
        { lat: 45.764043, lon: 4.835659, name: "Marca de Joyas, Lyon" },
        { lat: 43.610769, lon: 1.444209, name: "Agencia Creativa, Toulouse" },
        { lat: 47.218371, lon: -1.553621, name: "Productora de Vídeo, Nantes" }
        ];
        
        // Convert lat/lon to 3D coordinates and screen position
        function latLonToVector3(lat, lon, radius) {
            const phi = (90 - lat) * Math.PI / 180;
            const theta = (lon + 180) * Math.PI / 180;
            return new THREE.Vector3(
            -radius * Math.sin(phi) * Math.cos(theta),
            radius * Math.cos(phi),
            radius * Math.sin(phi) * Math.sin(theta)
            );
        }
        
        // Create star points using HTML elements
        const starPoints = [];
        pointsData.forEach(point => {
            const position = latLonToVector3(point.lat, point.lon, radius + 0.15);
            const star = document.createElement('div');
            star.className = 'star-point';
            document.body.appendChild(star);
            starPoints.push({ element: star, position });
        });
        
        // Update star point positions
        function updateStarPositions() {
            starPoints.forEach(star => {
                const vector = star.position.clone();
                vector.project(camera);
                const x = (vector.x + 1) * window.innerWidth / 2;
                const y = -(vector.y - 1) * window.innerHeight / 2;
                star.element.style.left = `${x - 10}px`; // Center the 20px star
                star.element.style.top = `${y - 10}px`;  // Center the 20px star
            });
        }
        
        // Position camera to focus on Spain (centered on Madrid)
        const spainPosition = latLonToVector3(40.416775, -3.703790, radius + 20);
        camera.position.copy(spainPosition);
        camera.lookAt(0, 0, 0);
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
            updateStarPositions(); // Update star positions with camera movement
        }
        animate();
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            updateStarPositions();
        });
    </script>
    
    <script>
        // Generate random stars
        const starContainer = document.getElementById("stars");
        const numStars = 150;
        
        for (let i = 0; i < numStars; i++) {
            const star = document.createElement("div");
            star.className = "star";
            star.style.top = `${Math.random() * 100}%`;
            star.style.left = `${Math.random() * 100}%`;
            star.style.animationDuration = `${2 + Math.random() * 3}s`;
            star.style.opacity = Math.random() * 0.6 + 0.4;
            starContainer.appendChild(star);
        }
    </script>
</body>
</html>